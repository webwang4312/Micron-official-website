{"remainingRequest":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\thread-loader\\dist\\cjs.js!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\babel-loader\\lib\\index.js!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\src\\views\\pc\\Vote.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\src\\views\\pc\\Vote.vue","mtime":1621431023000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/weimi/Micron-official-website/\\u5FAE\\u7C73\\u5B98\\u7F51/uenc/uenc/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { GetPollList, GetDictList, GetPoll, DetailInfo } from \"@/assets/server/api.js\";\nimport { log } from \"util\";\nexport default {\n  data: function data() {\n    return {\n      statusPoll: \"\",\n      itemPoll: null,\n      numPoll: \"\",\n      searchForm: {\n        title: \"\",\n        status: \"\",\n        pageNo: 1,\n        pageSize: 10\n      },\n      statusList: [],\n      currentPage: 1,\n      proposalList: [],\n      total: 0,\n      dialogVisible: false,\n      pollNumber: 0,\n      poll: false,\n      exec: false\n    };\n  },\n  created: function created() {\n    var loginName = localStorage.getItem(\"username\");\n    this.searchForm.loginName = loginName;\n  },\n  mounted: function mounted() {\n    this.getProposalList();\n    this.getDictList();\n  },\n  methods: {\n    isPoll: function () {\n      var _isPoll = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(status, list) {\n        var data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(list.userPollStatus === 0)) {\n                  _context.next = 9;\n                  break;\n                }\n\n                this.statusPoll = status;\n                this.itemPoll = list;\n                _context.next = 5;\n                return DetailInfo({\n                  loginName: this.searchForm.loginName,\n                  id: list.id\n                });\n\n              case 5:\n                data = _context.sent;\n\n                if (data.code == 0) {\n                  this.pollNumber = data.data.pollNumber;\n                  this.poll = data.data.poll;\n                  this.exec = data.data.exec;\n\n                  if (this.poll) {\n                    if (this.pollNumber / 1 < 1000) {\n                      this.$message.error(this.$t(\"index.switch\") === \"cn\" ? \"余额至少1000以上才可以投票哦！\" : \"Only with a balance of at least 1000 can you vote!\");\n                    } else {\n                      this.dialogVisible = true;\n                    }\n                  } else {\n                    this.$message.error(this.$t(\"index.switch\") === \"cn\" ? \"您没有投票权限！\" : \"You do not have the right to vote!\");\n                  }\n                }\n\n                _context.next = 10;\n                break;\n\n              case 9:\n                this.$message.error(this.$t(\"index.switch\") === \"cn\" ? \"您已参与本次投票!\" : \"You have participated in this poll！\");\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function isPoll(_x, _x2) {\n        return _isPoll.apply(this, arguments);\n      }\n\n      return isPoll;\n    }(),\n    close: function close() {\n      this.statusPoll = 0;\n      this.dialogVisible = false;\n      this.itemPoll = null;\n      this.numPoll = \"\";\n    },\n    getPoll: function () {\n      var _getPoll = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var loginName, data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                loginName = localStorage.getItem(\"username\");\n\n                if (!(this.itemPoll.userPollStatus != \"0\")) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this.$message.warning(this.$t(\"index.switch\") === \"cn\" ? \"已投票，请勿重复投递！\" : \"Voted, do not repeat!\"));\n\n              case 3:\n                if (!(this.numPoll < 1000)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this.$message.warning(this.$t(\"index.switch\") === \"cn\" ? \"投票数量不得小于1000\" : \"The number of votes must not be less than 1,000\"));\n\n              case 5:\n                if (!(this.numPoll > this.pollNumber)) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this.$message.warning(this.$t(\"index.switch\") === \"cn\" ? \"可用余额不足\" : \"Insufficient available balance\"));\n\n              case 7:\n                _context2.next = 9;\n                return GetPoll({\n                  loginName: loginName,\n                  proposalId: this.itemPoll.id,\n                  status: this.statusPoll,\n                  num: this.numPoll,\n                  mark: this.itemPoll.status\n                });\n\n              case 9:\n                data = _context2.sent;\n\n                if (data.code === 0) {\n                  this.$message.success(this.$t(\"index.switch\") === \"cn\" ? \"投票成功！\" : \"success\");\n                  this.getProposalList();\n                  this.close();\n                } else {\n                  this.$message.error(dataList.msg);\n                }\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getPoll() {\n        return _getPoll.apply(this, arguments);\n      }\n\n      return getPoll;\n    }(),\n    getProposalList: function () {\n      var _getProposalList = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var dataList;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return GetPollList(this.searchForm);\n\n              case 2:\n                dataList = _context3.sent;\n\n                if (dataList.code === 0) {\n                  if (!dataList.rows.length) this.$message.warning(this.$t(\"index.switch\") === \"cn\" ? \"暂无内容\" : 'No content');\n                  dataList.rows.forEach(function (item) {\n                    item.summary = item.summary.replace(/\\n/g, \"<br>\");\n                  });\n                  this.total = dataList.total;\n                  this.proposalList = dataList.rows;\n                } else {\n                  this.$message.error(dataList.msg);\n                }\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getProposalList() {\n        return _getProposalList.apply(this, arguments);\n      }\n\n      return getProposalList;\n    }(),\n    getDictList: function () {\n      var _getDictList = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var dataList;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return GetDictList({\n                  dictType: \"sys_poll_status\"\n                });\n\n              case 2:\n                dataList = _context4.sent;\n\n                if (dataList.code === 0) {\n                  this.statusList = dataList.rows;\n                } else {\n                  this.$message.error(dataList.msg);\n                }\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getDictList() {\n        return _getDictList.apply(this, arguments);\n      }\n\n      return getDictList;\n    }(),\n    search: function search() {\n      this.getProposalList();\n    },\n    getStatus: function getStatus(type) {\n      var label = \"无状态\";\n\n      var _iterator = _createForOfIteratorHelper(this.statusList),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var key = _step.value;\n\n          if (key.dictValue == type) {\n            label = key.dictLabel;\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return label;\n    },\n    details: function details(id) {\n      this.$router.push({\n        path: \"/pc/community/Proposal/Details\",\n        query: {\n          id: id,\n          type: \"vote\",\n          exec: this.exec\n        }\n      });\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.searchForm.pageSize = val;\n      this.getProposalList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.searchForm.pageNo = val;\n      this.getProposalList();\n    }\n  }\n};",{"version":3,"sources":["Vote.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\n * @Author: yaoyuting\n * @Date: 2021-04-18 18:04:59\n * @LastEditors: yaoyuting\n * @LastEditTime: 2021-05-18 21:12:52\n * @Descripttion: \n-->\n<template>\n  <div class=\"Proposal\">\n    <div class=\"search\">\n      <el-form :inline=\"true\" :model=\"searchForm\" class=\"demo-form-inline\">\n        <el-form-item label=\"\">\n          <el-input\n            class=\"title_bn\"\n            v-model=\"searchForm.title\"\n            :placeholder=\"$t('Proposal.title')\"\n            style=\"width: 320px\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"\">\n          <el-select\n            class=\"status_bn\"\n            v-model=\"searchForm.status\"\n            :placeholder=\"$t('Vote.State')\"\n            clearable\n            style=\"width: 320px\"\n          >\n            <el-option\n              class=\"statusItem\"\n              v-for=\"item in statusList\"\n              :key=\"item.dictValue\"\n              :label=\"item.dictLabel\"\n              :value=\"item.dictValue\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <span class=\"btn\" @click=\"search\">{{ $t(\"Proposal.Search\") }}</span>\n        </el-form-item>\n      </el-form>\n    </div>\n    <div class=\"content\" v-if=\"proposalList.length > 0\">\n      <div class=\"w1300\">\n        <template v-for=\"list in proposalList\">\n          <div class=\"details\" :key=\"list.id\">\n            <div class=\"head\">\n              <div class=\"num\" @click=\"details(list.id)\">{{ list.id }}</div>\n              <div class=\"cen\" @click=\"details(list.id)\">\n                <div class=\"title\">{{ list.title }}</div>\n                <div class=\"bottom\">\n                  <div class=\"people\">{{ $t(\"Proposal.Proposer\") }}:{{ list.name }}</div>\n                  <!-- <div class=\"date\">{{$t('Proposal.deadline')}} ：{{ list.deadline }}</div> -->\n                  <div class=\"status\">\n                    {{ $t(\"Proposal.status\") }} ：{{ getStatus(list.status) }}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class=\"text\" v-html=\"list.summary\">{{ list.summary }}</div>\n\n            <div class=\"votes\">\n              <div class=\"num\">\n                <span>{{ list.approve }}</span>\n                <span class=\"r\">{{ list.oppose }}</span>\n              </div>\n              <div class=\"meddile\">\n                <div\n                  class=\"approve\"\n                  :style=\"\n                    `width: ${\n                      list.approve\n                        ? (\n                            (Number(list.approve) / (list.approve + Number(list.oppose))) *\n                            100\n                          ).toFixed(2)\n                        : list.approve == 0 && list.oppose == 0\n                        ? 50\n                        : 0\n                    }%`\n                  \"\n                ></div>\n                <div\n                  class=\"c\"\n                  v-if=\"\n                    !(list.approve == 0 && list.oppose > 0) &&\n                      !(list.approve > 0 && list.oppose == 0)\n                  \"\n                >\n                  <span class=\"iconfont iconlan\"></span>\n                  <span class=\"iconfont iconhong\"></span>\n                </div>\n                <div\n                  class=\"oppose\"\n                  :style=\"\n                    ` width: ${\n                      list.oppose\n                        ? (\n                            (list.oppose / (Number(list.approve) + Number(list.oppose))) *\n                            100\n                          ).toFixed(2)\n                        : list.approve == 0 && list.oppose == 0\n                        ? 50\n                        : 0\n                    }%`\n                  \"\n                ></div>\n              </div>\n              <div class=\"foot\">\n                <div @click=\"isPoll(1, list)\">\n                  {{ list.userPollStatus === 1 ? $t(\"Proposal.agreea\") : $t(\"Proposal.agree\") }}\n                  <img src=\"@/assets/images/icon/点赞 (1).png\" alt=\"\" />\n                </div>\n                <div @click=\"isPoll(2, list)\" class=\"r\">\n                  {{ list.userPollStatus === 2 ? $t(\"Proposal.opposea\") : $t(\"Proposal.oppose\")\n                  }}<img src=\"@/assets/images/icon/点赞.png\" alt=\"\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        </template>\n      </div>\n\n      <div class=\"page\">\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"searchForm.pageNo\"\n          :page-sizes=\"[5, 10, 15, 20]\"\n          :page-size=\"searchForm.pageSize\"\n          layout=\"total, prev, pager, next, jumper\"\n          :total=\"total\"\n          background\n        >\n        </el-pagination>\n      </div>\n    </div>\n    <div class=\"nodata\" v-else>\n      {{ $t(\"index.switch\") === \"cn\" ? \"暂无数据\" : \"Empty data\" }}\n    </div>\n    <el-dialog\n      custom-class=\"vote-dialog\"\n      :title=\"$t('dialog.Number')\"\n      :visible=\"dialogVisible\"\n      width=\"600px\"\n      :before-close=\"close\"\n    >\n      <el-input v-model=\"numPoll\" :placeholder=\"$t('dialog.less')\"></el-input>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <div class=\"dialog-btn\" @click=\"getPoll\">{{ $t(\"dialog.confirm\") }}</div>\n        <div class=\"dialog-btn close\" @click=\"close\">{{ $t(\"dialog.cancel\") }}</div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { GetPollList, GetDictList, GetPoll, DetailInfo } from \"@/assets/server/api.js\";\nimport { log } from \"util\";\nexport default {\n  data() {\n    return {\n      statusPoll: \"\",\n      itemPoll: null,\n      numPoll: \"\",\n      searchForm: {\n        title: \"\",\n        status: \"\",\n        pageNo: 1,\n        pageSize: 10\n      },\n      statusList: [],\n      currentPage: 1,\n      proposalList: [],\n      total: 0,\n      dialogVisible: false,\n      pollNumber: 0,\n      poll: false,\n      exec: false\n    };\n  },\n  created() {\n    let loginName = localStorage.getItem(\"username\");\n    this.searchForm.loginName = loginName;\n  },\n  mounted() {\n    this.getProposalList();\n    this.getDictList();\n  },\n  methods: {\n    async isPoll(status, list) {\n      if (list.userPollStatus === 0) {\n        this.statusPoll = status;\n        this.itemPoll = list;\n        const data = await DetailInfo({\n          loginName: this.searchForm.loginName,\n          id: list.id\n        });\n        if (data.code == 0) {\n          this.pollNumber = data.data.pollNumber;\n          this.poll = data.data.poll;\n          this.exec = data.data.exec;\n          if (this.poll) {\n            if (this.pollNumber / 1 < 1000) {\n              this.$message.error(\n                this.$t(\"index.switch\") === \"cn\"\n                  ? \"余额至少1000以上才可以投票哦！\"\n                  : \"Only with a balance of at least 1000 can you vote!\"\n              );\n            } else {\n              this.dialogVisible = true;\n            }\n          } else {\n            this.$message.error(\n              this.$t(\"index.switch\") === \"cn\"\n                ? \"您没有投票权限！\"\n                : \"You do not have the right to vote!\"\n            );\n          }\n        }\n      } else {\n        this.$message.error(\n          this.$t(\"index.switch\") === \"cn\"\n            ? \"您已参与本次投票!\"\n            : \"You have participated in this poll！\"\n        );\n      }\n    },\n    close() {\n      this.statusPoll = 0;\n      this.dialogVisible = false;\n      this.itemPoll = null;\n      this.numPoll = \"\";\n    },\n    async getPoll() {\n      let loginName = localStorage.getItem(\"username\");\n      if (this.itemPoll.userPollStatus != \"0\") {\n        return this.$message.warning(\n          this.$t(\"index.switch\") === \"cn\" ? \"已投票，请勿重复投递！\" : \"Voted, do not repeat!\"\n        );\n      }\n      if (this.numPoll < 1000) {\n        return this.$message.warning(\n          this.$t(\"index.switch\") === \"cn\"\n            ? \"投票数量不得小于1000\"\n            : \"The number of votes must not be less than 1,000\"\n        );\n      }\n      if (this.numPoll > this.pollNumber) {\n        return this.$message.warning(\n          this.$t(\"index.switch\") === \"cn\" ? \"可用余额不足\" : \"Insufficient available balance\"\n        );\n      }\n      const data = await GetPoll({\n        loginName: loginName,\n        proposalId: this.itemPoll.id,\n        status: this.statusPoll,\n        num: this.numPoll,\n        mark: this.itemPoll.status\n      });\n      if (data.code === 0) {\n        this.$message.success(this.$t(\"index.switch\") === \"cn\" ? \"投票成功！\" : \"success\");\n        this.getProposalList();\n        this.close();\n      } else {\n        this.$message.error(dataList.msg);\n      }\n    },\n    async getProposalList() {\n      const dataList = await GetPollList(this.searchForm);\n      if (dataList.code === 0) {\n        if (!dataList.rows.length) this.$message.warning(this.$t(\"index.switch\") === \"cn\" ?\"暂无内容\":'No content' );\n        dataList.rows.forEach(item => {\n          item.summary = item.summary.replace(/\\n/g, \"<br>\");\n        });\n        this.total = dataList.total;\n        this.proposalList = dataList.rows;\n      } else {\n        this.$message.error(dataList.msg);\n      }\n    },\n    async getDictList() {\n      const dataList = await GetDictList({ dictType: \"sys_poll_status\" });\n      if (dataList.code === 0) {\n        this.statusList = dataList.rows;\n      } else {\n        this.$message.error(dataList.msg);\n      }\n    },\n    search() {\n      this.getProposalList();\n    },\n    getStatus(type) {\n      let label = \"无状态\";\n      for (const key of this.statusList) {\n        if (key.dictValue == type) {\n          label = key.dictLabel;\n          break;\n        }\n      }\n      return label;\n    },\n    details(id) {\n      this.$router.push({\n        path: \"/pc/community/Proposal/Details\",\n        query: { id: id, type: \"vote\", exec: this.exec }\n      });\n    },\n    handleSizeChange(val) {\n      this.searchForm.pageSize = val;\n      this.getProposalList();\n    },\n    handleCurrentChange(val) {\n      this.searchForm.pageNo = val;\n      this.getProposalList();\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n.statusItem.el-select-dropdown__item {\n  height: 48px;\n  line-height: 48px;\n  font-size: 22px;\n}\n.Proposal {\n  .nodata {\n    text-align: center;\n    font-size: 40px;\n    margin: 100px 0;\n  }\n  .title_bn {\n    width: 670px !important;\n    height: 78px;\n    input {\n      height: 78px;\n      font-size: 32px;\n    }\n    input::placeholder {\n      font-size: 32px;\n      color: #9a9a9a;\n      height: 78px;\n      line-height: 78px;\n    }\n  }\n\n  .status_bn {\n    width: 270px !important;\n    height: 78px;\n    input {\n      height: 78px;\n      font-size: 32px;\n    }\n    i {\n      font-size: 24px !important;\n    }\n    input::placeholder {\n      font-size: 32px;\n      color: #9a9a9a;\n      height: 78px;\n      line-height: 78px;\n    }\n  }\n}\n.vote-dialog {\n  width: 600px;\n  height: 417px;\n  border-radius: 25px;\n  .el-dialog__header {\n    padding: 30px 60px;\n    .el-dialog__title {\n      font-size: 28px;\n    }\n    .el-dialog__headerbtn {\n      top: 30px;\n    }\n    .el-dialog__close {\n      font-size: 26px;\n      color: #305bbc;\n    }\n  }\n  .el-dialog__body {\n    padding: 40px 60px 60px;\n    .el-input__inner {\n      width: 480px;\n      height: 70px;\n      background: #ffffff;\n      border: 1px solid #999999;\n      border-radius: 3px;\n      font-size: 24px;\n      border: 1px solid #999999;\n    }\n  }\n  .el-dialog__footer {\n    padding-ottom: 60px;\n    .dialog-footer {\n      display: flex;\n      justify-content: center;\n    }\n\n    .dialog-btn {\n      width: 158px;\n      line-height: 70px;\n      height: 70px;\n      text-align: center;\n      background: #4c67ef;\n      border-radius: 4px;\n      font-size: 28px;\n      color: #ffffff;\n      margin: 0 28px;\n      cursor: pointer;\n    }\n    .close {\n      background: #afb7e0;\n    }\n  }\n}\n</style>\n<style lang=\"less\" scoped>\n.Proposal {\n  .btn {\n    width: 200px;\n    height: 78px;\n    border: 2px solid #ffffff;\n    border-radius: 10px;\n    font-size: 32px;\n    text-align: center;\n    color: #ffffff;\n    line-height: 78px;\n    display: inline-block;\n    margin-right: 20px;\n  }\n  .search {\n    height: 900px;\n    background-image: url(\"../../assets/images/index/Developersbg.png\");\n    background-size: cover;\n    background-position: center center;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n  }\n  .content {\n    background-image: url(\"../../assets/images/index/votebg.png\");\n    background-size: cover;\n    background-position: center center;\n    overflow: hidden;\n  }\n  .details {\n    margin-top: 86px;\n    .head {\n      display: flex;\n      align-items: center;\n      .num {\n        width: 80px;\n        height: 80px;\n        line-height: 80px;\n        text-align: center;\n        background-color: #5459ff;\n        color: #fff;\n        font-size: 32px;\n        font-weight: bold;\n        border-radius: 6px;\n        cursor: pointer;\n      }\n      .cen {\n        padding: 0 10px;\n        flex: 1;\n        cursor: pointer;\n        .title {\n          font-size: 32px;\n          height: 45px;\n          line-height: 45px;\n          color: #333;\n          overflow: hidden;\n          display: -webkit-box;\n          -webkit-box-orient: vertical;\n          -webkit-line-clamp: 1;\n        }\n        .bottom {\n          display: flex;\n          justify-content: space-between;\n          font-size: 24px;\n          font-family: PingFangSC-Regular, PingFang SC;\n          font-weight: 400;\n          color: #323232;\n          line-height: 40px;\n          margin-top: 10px;\n        }\n      }\n    }\n    .text {\n      margin: 18px 10px;\n      word-break: break-all;\n      display: -webkit-box;\n      -webkit-box-orient: vertical;\n      -webkit-line-clamp: 3;\n      overflow: hidden;\n      font-size: 24px;\n      font-family: PingFangSC-Regular, PingFang SC;\n      font-weight: 400;\n      color: #656565;\n      line-height: 40px;\n    }\n    .votes {\n      .num {\n        display: flex;\n        justify-content: space-between;\n        font-size: 44px;\n        color: #053ffb;\n        .r {\n          color: #f1594c;\n        }\n      }\n      .meddile {\n        height: 40px;\n        border-radius: 56px;\n        overflow: hidden;\n        display: flex;\n        .approve {\n          height: 40px;\n          background: linear-gradient(90deg, #4d71ff, #003cfb);\n        }\n        .c {\n          display: flex;\n          align-items: center;\n          span {\n            font-size: 46px;\n          }\n          .iconlan {\n            color: #003cfb;\n            margin-right: -14px;\n            margin-left: -2px;\n            margin-top: -2px;\n          }\n          .iconhong {\n            color: #ed4038;\n            margin-left: -14px;\n            margin-right: -2px;\n            margin-bottom: -2px;\n          }\n        }\n        .oppose {\n          height: 40px;\n          background: linear-gradient(270deg, #f78069, #ed4038);\n        }\n      }\n      .foot {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 14px;\n        div {\n          width: 164px;\n          height: 54px;\n          background: linear-gradient(90deg, #4d71ff, #003cfb);\n          border-radius: 56px;\n          font-size: 24px;\n          color: #ffffff;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          cursor: pointer;\n          img {\n            width: 24px;\n            margin: 0 6px;\n          }\n        }\n        .r {\n          background: linear-gradient(270deg, #f78069, #ed4038);\n        }\n      }\n    }\n  }\n  .page {\n    margin-top: 150px;\n    text-align: center;\n    margin-bottom: 160px;\n  }\n}\n</style>\n"],"sourceRoot":"src/views/pc"}]}