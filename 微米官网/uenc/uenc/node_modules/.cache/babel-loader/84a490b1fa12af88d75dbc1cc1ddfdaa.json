{"remainingRequest":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\thread-loader\\dist\\cjs.js!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\babel-loader\\lib\\index.js!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\src\\views\\m\\Proposal\\Details.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\src\\views\\m\\Proposal\\Details.vue","mtime":1621478359000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\weimi\\Micron-official-website\\微米官网\\uenc\\uenc\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:/weimi/Micron-official-website/\\u5FAE\\u7C73\\u5B98\\u7F51/uenc/uenc/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { GetDictList, GetPoll, AddImplPlan, DetailInfo, AddImplPlanOver } from \"@/assets/server/api.js\";\nimport { baseURL } from \"@/utils/utils\";\nexport default {\n  data: function data() {\n    return {\n      statusPoll: \"\",\n      itemPoll: null,\n      numPoll: \"\",\n      ProposaData: [],\n      statusProposaData: [],\n      plan: \"\",\n      exec: false,\n      poll: false,\n      pollNumber: \"\",\n      dialogVisible: false\n    };\n  },\n  created: function created() {\n    this.getDictProposaData();\n    this.isPoll();\n  },\n  methods: {\n    close: function close() {\n      this.statusPoll = 0;\n      this.dialogVisible = false;\n      this.itemPoll = null;\n      this.numPoll = \"\";\n    },\n    getPollStatus: function getPollStatus(status, list) {\n      if (list.userPollStatus === 0) {\n        this.statusPoll = status;\n        this.itemPoll = list;\n\n        if ((this.ProposaData.status == \"1\" || this.ProposaData.status == \"3\" || this.ProposaData.status == \"4\") && this.poll) {\n          this.getPoll(\"pro\");\n        } else {\n          if (this.poll) {\n            if (this.pollNumber / 1 < 1000 && this.$route.query.type === \"vote\") {\n              this.$notify({\n                type: \"error\",\n                message: this.$t(\"index.switch\") === \"cn\" ? \"余额至少1000以上才可以投票哦！\" : \"balance of at least 1000\"\n              });\n            } else {\n              this.dialogVisible = true;\n            }\n          } else {\n            this.$notify({\n              type: \"error\",\n              message: this.$t(\"index.switch\") === \"cn\" ? \"您没有投票权限！\" : \"not have the right to vote!\"\n            });\n          }\n        }\n      } else {\n        this.$notify({\n          type: \"error\",\n          message: this.$t(\"index.switch\") === \"cn\" ? \"您已参与本次投票!\" : \"participated in this poll！\"\n        });\n      }\n    },\n    isPoll: function () {\n      var _isPoll = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var loginName, id, data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                loginName = localStorage.getItem(\"username\");\n                id = this.$route.query.id;\n                _context.next = 4;\n                return DetailInfo({\n                  loginName: loginName,\n                  id: id\n                });\n\n              case 4:\n                data = _context.sent;\n\n                if (data.code == 0) {\n                  this.ProposaData = data.data;\n                  this.pollNumber = data.data.pollNumber;\n                  this.poll = data.data.poll;\n                  this.exec = data.data.exec;\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function isPoll() {\n        return _isPoll.apply(this, arguments);\n      }\n\n      return isPoll;\n    }(),\n    success: function () {\n      var _success = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return AddImplPlanOver({\n                  id: this.$route.query.id\n                });\n\n              case 2:\n                data = _context2.sent;\n\n                if (data.code == 0) {\n                  this.isPoll();\n                }\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function success() {\n        return _success.apply(this, arguments);\n      }\n\n      return success;\n    }(),\n    submit: function () {\n      var _submit = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(this.plan == \"\")) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", this.$notify({\n                  type: \"error\",\n                  message: this.$t(\"index.switch\") === \"cn\" ? \"请输入内容！\" : \"Enter content!\"\n                }));\n\n              case 2:\n                _context3.next = 4;\n                return AddImplPlan({\n                  proposalId: this.ProposaData.id,\n                  content: this.plan,\n                  createBy: this.ProposaData.createBy\n                });\n\n              case 4:\n                data = _context3.sent;\n\n                if (data.code == 0) {\n                  this.plan = \"\";\n                  this.isPoll();\n                }\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }(),\n    getPoll: function () {\n      var _getPoll = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var type,\n            loginName,\n            data,\n            _args4 = arguments;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                type = _args4.length > 0 && _args4[0] !== undefined ? _args4[0] : \"\";\n\n                if (!(type !== \"pro\")) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                if (!(this.itemPoll.userPollStatus != \"0\")) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", this.$notify({\n                  type: \"warning\",\n                  message: this.$t(\"index.switch\") === \"cn\" ? \"已投票，请勿重复投递！\" : \"Voted, do not repeat!\"\n                }));\n\n              case 4:\n                if (!(this.numPoll < 1000 && this.$route.query.type === \"vote\")) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", this.$notify({\n                  type: \"warning\",\n                  message: this.$t(\"index.switch\") === \"cn\" ? \"投票数量不得小于1000\" : \"Quantity less than 1000\"\n                }));\n\n              case 6:\n                if (!(this.numPoll > this.pollNumber)) {\n                  _context4.next = 8;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", this.$notify({\n                  type: \"warning\",\n                  message: this.$t(\"index.switch\") === \"cn\" ? \"可用余额不足\" : \"Lack of balance\"\n                }));\n\n              case 8:\n                _context4.next = 11;\n                break;\n\n              case 10:\n                this.numPoll = 1;\n\n              case 11:\n                loginName = localStorage.getItem(\"username\");\n                _context4.next = 14;\n                return GetPoll({\n                  loginName: loginName,\n                  proposalId: this.itemPoll.id,\n                  status: this.statusPoll,\n                  num: this.numPoll,\n                  mark: this.itemPoll.status\n                });\n\n              case 14:\n                data = _context4.sent;\n\n                if (data.code === 0) {\n                  this.$notify({\n                    type: \"success\",\n                    message: this.$t(\"index.switch\") === \"cn\" ? \"投票成功！\" : \"success\"\n                  });\n                  this.isPoll();\n                  this.close();\n                } else {\n                  this.$message.error(dataList.msg);\n                }\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getPoll() {\n        return _getPoll.apply(this, arguments);\n      }\n\n      return getPoll;\n    }(),\n    getDictProposaData: function () {\n      var _getDictProposaData = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        var dataProposaData;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return GetDictList({\n                  dictType: \"sys_proposal_status\"\n                });\n\n              case 2:\n                dataProposaData = _context5.sent;\n\n                if (dataProposaData.code === 0) {\n                  this.statusProposaData = dataProposaData.rows;\n                } else {\n                  this.$message.error(dataProposaData.msg);\n                }\n\n              case 4:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getDictProposaData() {\n        return _getDictProposaData.apply(this, arguments);\n      }\n\n      return getDictProposaData;\n    }(),\n    getStatus: function getStatus(type) {\n      var label = \"无状态\";\n\n      var _iterator = _createForOfIteratorHelper(this.statusProposaData),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var key = _step.value;\n\n          if (key.dictValue == type) {\n            label = key.dictLabel;\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return label;\n    }\n  }\n};",{"version":3,"sources":["Details.vue"],"names":[],"mappings":"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","sourcesContent":["<!--\n * @Author: yaoyuting\n * @Date: 2021-04-25 20:37:07\n * @LastEditors: yaoyuting\n * @LastEditTime: 2021-05-19 21:32:08\n * @Descripttion: \n-->\n<template>\n  <div class=\"ProposaDetails\">\n    <div class=\"banner\">\n      <div class=\"placeholder\"></div>\n      <div class=\"details\">\n        <div class=\"item\">{{ $t(\"Proposal.Proposer\") }}：{{ ProposaData.name }}</div>\n        <div class=\"item\">{{ $t(\"Proposal.Creation\") }}：{{ ProposaData.createTime }}</div>\n        <div class=\"item\">{{ $t(\"Proposal.status\") }}：{{ getStatus(ProposaData.status) }}</div>\n        <div class=\"item\">{{ $t(\"Proposal.number\") }}：{{ ProposaData.id }}</div>\n        <div class=\"title\">{{ ProposaData.title }}</div>\n        <div class=\"votes\">\n          <!-- <div class=\"num\">\n            <span>{{ ProposaData.approve }}</span>\n            <span class=\"r\">{{ ProposaData.oppose }}</span>\n          </div> -->\n          <div class=\"meddile\">\n            <div\n              class=\"approve\"\n              :style=\"\n                `width: ${\n                  ProposaData.approve\n                    ? (\n                        (Number(ProposaData.approve) /\n                          (ProposaData.approve + Number(ProposaData.oppose))) *\n                        100\n                      ).toFixed(2)\n                    : ProposaData.approve == 0 && ProposaData.oppose == 0\n                    ? 50\n                    : 0\n                }%`\n              \"\n            >\n              <span>{{ ProposaData.approve }} </span>\n            </div>\n            <div\n              class=\"c\"\n              v-if=\"\n                !(ProposaData.approve == 0 && ProposaData.oppose > 0) &&\n                  !(ProposaData.approve > 0 && ProposaData.oppose == 0)\n              \"\n            >\n              <span class=\"iconfont iconlan\"></span>\n              <span class=\"iconfont iconhong\"></span>\n            </div>\n            <div\n              class=\"oppose\"\n              :style=\"\n                ` width: ${\n                  ProposaData.oppose\n                    ? (\n                        (ProposaData.oppose /\n                          (Number(ProposaData.approve) + Number(ProposaData.oppose))) *\n                        100\n                      ).toFixed(2)\n                    : ProposaData.approve == 0 && ProposaData.oppose == 0\n                    ? 50\n                    : 0\n                }%`\n              \"\n            >\n              <span> {{ ProposaData.oppose }}</span>\n            </div>\n          </div>\n          <div class=\"foot\">\n            <div @click=\"getPollStatus(1, ProposaData)\">\n              {{ ProposaData.userPollStatus === 1 ? $t(\"Proposal.agreea\") : $t(\"Proposal.agree\") }}\n              <img src=\"@/assets/images/icon/点赞 (1).png\" alt=\"暂无图片\" />\n            </div>\n            <div @click=\"getPollStatus(2, ProposaData)\" class=\"r\">\n              {{ ProposaData.userPollStatus === 2 ? $t(\"Proposal.opposea\") : $t(\"Proposal.oppose\")\n              }}<img src=\"@/assets/images/icon/点赞.png\" alt=\"暂无图片\" />\n            </div>\n          </div>\n          <!-- <div class=\"foot\">\n            <div @click=\"isPoll(1, ProposaData)\">\n              {{ ProposaData.userPollStatus === 1 ? \"已\" : \"\" }}赞成\n              <img src=\"@/assets/images/icon/点赞 (1).png\"  alt=\"暂无图片\" />\n            </div>\n            <div @click=\"isPoll(2, ProposaData)\" class=\"r\">\n              <img src=\"@/assets/images/icon/点赞.png\"  alt=\"暂无图片\" />{{\n                ProposaData.userPollStatus === 2 ? \"已\" : \"\"\n              }}反对\n            </div>\n          </div> -->\n        </div>\n      </div>\n    </div>\n    <div class=\"content_bg\">\n      <div class=\"content\">\n        <div class=\"top\">\n          <div class=\"lebelTitle\">{{ $t(\"Proposal.Abstract\") }}</div>\n          <div class=\"bg\"></div>\n        </div>\n        <div class=\"text\" v-html=\"ProposaData.summary\"></div>\n        <div class=\"top\">\n          <div class=\"lebelTitle\">{{ $t(\"Proposal.Target\") }}</div>\n          <div class=\"bg\"></div>\n        </div>\n        <div class=\"text\">{{ ProposaData.target }}</div>\n        <div class=\"top\">\n          <div class=\"lebelTitle\">{{ $t(\"Proposal.Plan\") }}</div>\n          <div class=\"bg\"></div>\n        </div>\n        <div class=\"text\">{{ ProposaData.plan }}</div>\n        <div class=\"top\">\n          <div class=\"lebelTitle\">{{ $t(\"Proposal.Budget\") }}</div>\n          <div class=\"bg\"></div>\n        </div>\n        <div class=\"text\">{{ ProposaData.budget }}</div>\n        <div class=\"planList\">\n          <div\n            class=\"top\"\n            v-if=\"\n              ProposaData &&\n                ProposaData.implPlanList &&\n                JSON.stringify(ProposaData.implPlanList) !== '{}'\n            \"\n          >\n            <div class=\"lebelTitle\">{{ $t(\"Proposal.Implementation\") }}</div>\n            <div class=\"bg\"></div>\n          </div>\n          <div\n            class=\"title_about\"\n            v-if=\"\n              ProposaData &&\n                ProposaData.implPlanList &&\n                JSON.stringify(ProposaData.implPlanList) !== '{}'\n            \"\n          >\n            {{ ProposaData.implPlan }}\n          </div>\n          <div\n            class=\"details_text\"\n            v-if=\"\n              ProposaData &&\n                ProposaData.implPlanList &&\n                JSON.stringify(ProposaData.implPlanList) !== '{}'\n            \"\n          >\n            <div class=\"sub_title\">{{ $t(\"Proposal.Progress\") }}</div>\n            <div class=\"list\" v-for=\"(list, date) in ProposaData.implPlanList\" :key=\"date\">\n              <div class=\"date\">{{ date }}</div>\n              <div class=\"right\">\n                <div class=\"item\" v-for=\"item in list\" :key=\"item.id\">\n                  {{ item.content }}\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"exec_bottom\" v-if=\"exec\">\n            <div class=\"plan\">\n              <el-input type=\"textarea\" rows=\"6\" v-model=\"plan\"></el-input>\n            </div>\n            <div class=\"btn\">\n              <el-button type=\"primary\" @click=\"success\">{{ $t(\"Proposal.complete\") }}</el-button>\n              <el-button type=\"primary\" @click=\"submit\">{{ $t(\"Proposal.submit\") }}</el-button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <el-dialog\n      custom-class=\"vote-dialog\"\n      :title=\"$t('dialog.Number')\"\n      :visible=\"dialogVisible\"\n      width=\"85%\"\n      :before-close=\"close\"\n      :show-close=\"false\"\n    >\n      <el-input v-model=\"numPoll\" :placeholder=\"$t('dialog.less')\"></el-input>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"close\">{{ $t(\"dialog.cancel\") }}</el-button>\n        <el-button @click=\"getPoll\">{{ $t(\"dialog.confirm\") }}</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport {\n  GetDictList,\n  GetPoll,\n  AddImplPlan,\n  DetailInfo,\n  AddImplPlanOver\n} from \"@/assets/server/api.js\";\nimport { baseURL } from \"@/utils/utils\";\nexport default {\n  data() {\n    return {\n      statusPoll: \"\",\n      itemPoll: null,\n      numPoll: \"\",\n      ProposaData: [],\n      statusProposaData: [],\n      plan: \"\",\n      exec: false,\n      poll: false,\n      pollNumber: \"\",\n      dialogVisible: false\n    };\n  },\n  created() {\n    this.getDictProposaData();\n    this.isPoll();\n  },\n  methods: {\n    close() {\n      this.statusPoll = 0;\n      this.dialogVisible = false;\n      this.itemPoll = null;\n      this.numPoll = \"\";\n    },\n    getPollStatus(status, list) {\n      if (list.userPollStatus === 0) {\n        this.statusPoll = status;\n        this.itemPoll = list;\n        if (\n          (this.ProposaData.status == \"1\" ||\n            this.ProposaData.status == \"3\" ||\n            this.ProposaData.status == \"4\") &&\n          this.poll\n        ) {\n          this.getPoll(\"pro\");\n        } else {\n          if (this.poll) {\n            if (this.pollNumber / 1 < 1000 && this.$route.query.type === \"vote\") {\n              this.$notify({\n                type: \"error\",\n                message:\n                  this.$t(\"index.switch\") === \"cn\"\n                    ? \"余额至少1000以上才可以投票哦！\"\n                    : \"balance of at least 1000\"\n              });\n            } else {\n              this.dialogVisible = true;\n            }\n          } else {\n            this.$notify({\n              type: \"error\",\n              message:\n                this.$t(\"index.switch\") === \"cn\"\n                  ? \"您没有投票权限！\"\n                  : \"not have the right to vote!\"\n            });\n          }\n        }\n      } else {\n        this.$notify({\n          type: \"error\",\n          message:\n            this.$t(\"index.switch\") === \"cn\"\n              ? \"您已参与本次投票!\"\n              : \"participated in this poll！\"\n        });\n      }\n    },\n    async isPoll() {\n      let loginName = localStorage.getItem(\"username\");\n      let id = this.$route.query.id;\n      const data = await DetailInfo({\n        loginName: loginName,\n        id: id\n      });\n      if (data.code == 0) {\n        this.ProposaData = data.data;\n        this.pollNumber = data.data.pollNumber;\n        this.poll = data.data.poll;\n        this.exec = data.data.exec;\n      }\n    },\n    async success() {\n      const data = await AddImplPlanOver({\n        id: this.$route.query.id\n      });\n      if (data.code == 0) {\n        this.isPoll();\n      }\n    },\n    async submit() {\n      if (this.plan == \"\")\n        return this.$notify({\n          type: \"error\",\n          message: this.$t(\"index.switch\") === \"cn\" ? \"请输入内容！\" : \"Enter content!\"\n        });\n      const data = await AddImplPlan({\n        proposalId: this.ProposaData.id,\n        content: this.plan,\n        createBy: this.ProposaData.createBy\n      });\n      if (data.code == 0) {\n        this.plan = \"\";\n        this.isPoll();\n      }\n    },\n    async getPoll(type = \"\") {\n      if (type !== \"pro\") {\n        if (this.itemPoll.userPollStatus != \"0\") {\n          return this.$notify({\n            type: \"warning\",\n            message:\n              this.$t(\"index.switch\") === \"cn\" ? \"已投票，请勿重复投递！\" : \"Voted, do not repeat!\"\n          });\n        }\n        if (this.numPoll < 1000 && this.$route.query.type === \"vote\") {\n          return this.$notify({\n            type: \"warning\",\n            message:\n              this.$t(\"index.switch\") === \"cn\"\n                ? \"投票数量不得小于1000\"\n                : \"Quantity less than 1000\"\n          });\n        }\n        if (this.numPoll > this.pollNumber) {\n          return this.$notify({\n            type: \"warning\",\n            message:\n              this.$t(\"index.switch\") === \"cn\" ? \"可用余额不足\" : \"Lack of balance\"\n          });\n        }\n      } else {\n        this.numPoll = 1;\n      }\n      let loginName = localStorage.getItem(\"username\");\n      const data = await GetPoll({\n        loginName: loginName,\n        proposalId: this.itemPoll.id,\n        status: this.statusPoll,\n        num: this.numPoll,\n        mark: this.itemPoll.status\n      });\n      if (data.code === 0) {\n        this.$notify({\n          type: \"success\",\n          message: this.$t(\"index.switch\") === \"cn\" ? \"投票成功！\" : \"success\"\n        });\n        this.isPoll();\n        this.close();\n      } else {\n        this.$message.error(dataList.msg);\n      }\n    },\n    async getDictProposaData() {\n      const dataProposaData = await GetDictList({ dictType: \"sys_proposal_status\" });\n      if (dataProposaData.code === 0) {\n        this.statusProposaData = dataProposaData.rows;\n      } else {\n        this.$message.error(dataProposaData.msg);\n      }\n    },\n    getStatus(type) {\n      let label = \"无状态\";\n      for (const key of this.statusProposaData) {\n        if (key.dictValue == type) {\n          label = key.dictLabel;\n          break;\n        }\n      }\n      return label;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.banner {\n  height: 660px;\n  background-image: url(\"../../../assets/imagesm/indba2.png\");\n  background-size: cover;\n  background-position: center center;\n  display: flex;\n  flex-direction: column;\n  .placeholder {\n    flex: 1;\n  }\n  .details {\n    padding: 30px;\n    // padding-top: 184px;\n    .item {\n      font-size: 28px;\n      font-family: PingFangSC-Regular, PingFang SC;\n      font-weight: 400;\n      color: #ffffff;\n      margin-bottom: 18px;\n    }\n    .title {\n      font-size: 60px;\n      font-family: PingFang-SC-Heavy, PingFang-SC;\n      font-weight: 800;\n      color: #ffffff;\n      line-height: 84px;\n      margin-bottom: 40px;\n      max-height: 84px;\n      overflow: auto;\n    }\n  }\n  .votes {\n    .meddile {\n      height: 72px;\n      border-radius: 56px;\n      overflow: hidden;\n      display: flex;\n      .approve {\n        height: 72px;\n        line-height: 72px;\n        text-align: center;\n        background: linear-gradient(90deg, #4d71ff, #003cfb);\n        font-size: 26px;\n        font-family: PingFangSC-Medium, PingFang SC;\n        font-weight: 500;\n        color: #ffffff;\n      }\n      .c {\n        display: flex;\n        align-items: center;\n        span {\n          font-size: 76px;\n        }\n        .iconlan {\n          color: #003cfb;\n          margin-right: -14px;\n          margin-left: -2px;\n          margin-top: -2px;\n        }\n        .iconhong {\n          color: #ed4038;\n          margin-left: -14px;\n          margin-right: -2px;\n          margin-bottom: -2px;\n        }\n      }\n      .oppose {\n        height: 72px;\n        line-height: 72px;\n        text-align: center;\n        font-size: 26px;\n        font-family: PingFangSC-Medium, PingFang SC;\n        font-weight: 500;\n        color: #ffffff;\n        background: linear-gradient(270deg, #f78069, #ed4038);\n      }\n    }\n    .foot {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 14px;\n      div {\n        width: 164px;\n        height: 54px;\n        background: linear-gradient(90deg, #4d71ff, #003cfb);\n        border-radius: 56px;\n        font-size: 24px;\n        color: #ffffff;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        cursor: pointer;\n        img {\n          width: 24px;\n          margin: 0 6px;\n        }\n      }\n      .r {\n        background: linear-gradient(270deg, #f78069, #ed4038);\n      }\n    }\n  }\n}\n.content_bg {\n  background-image: url(\"../../../assets/imagesm/ta/bg2.png\");\n  background-size: 750px;\n}\n.content {\n  padding-bottom: 120px;\n  .top {\n    height: 128px;\n    padding-top: 54px;\n    padding-bottom: 24px;\n  }\n  .lebelTitle {\n    font-size: 36px;\n    font-family: PingFangSC-Medium, PingFang SC;\n    font-weight: 500;\n    color: #333333;\n    line-height: 50px;\n    margin-left: 30px;\n  }\n  .bg {\n    margin-left: 30px;\n    width: 97 * 2px;\n    height: 16px;\n    margin-top: -20px;\n    background: linear-gradient(270deg, rgba(141, 146, 255, 0), #5459ff);\n  }\n  .text {\n    padding: 32px;\n    background: #f6f6f6;\n    font-size: 24px;\n    font-family: PingFangSC-Regular, PingFang SC;\n    font-weight: 400;\n    color: #656565;\n    line-height: 40px;\n    word-break: break-all;\n  }\n  .planList {\n    .title_about {\n      font-size: 24px;\n      font-family: PingFangSC-Regular, PingFang SC;\n      font-weight: 400;\n      color: #656565;\n      line-height: 40px;\n      padding: 32px;\n    }\n    .details_text {\n      .sub_title {\n        font-size: 36px;\n        font-family: PingFangSC-Medium, PingFang SC;\n        font-weight: 400;\n        color: #333333;\n        line-height: 50px;\n        padding-left: 32px;\n        margin-bottom: 20px;\n      }\n      .list {\n        padding: 32px;\n        background: #f6f6f6;\n        font-size: 24px;\n        font-family: PingFangSC-Regular, PingFang SC;\n        font-weight: 400;\n        color: #656565;\n        line-height: 40px;\n        margin-bottom: 28px;\n        display: flex;\n        justify-content: flex-start;\n\n        .date {\n          font-size: 24px;\n          font-family: PingFangSC-Medium, PingFang SC;\n          font-weight: 500;\n          color: #666666;\n          line-height: 34px;\n          margin-bottom: 18px;\n          width: 150px;\n        }\n        .right {\n          width: calc(100% - 150px);\n        }\n        .item {\n          margin-bottom: 28px;\n        }\n      }\n    }\n    .exec_bottom {\n      margin: 32px;\n      .plan {\n        margin-bottom: 20px;\n      }\n      .btn {\n        display: flex;\n        justify-content: space-between;\n        .el-button {\n          width: 260px;\n          height: 72px;\n          background: #5432f4;\n          border-radius: 8px;\n          border: none;\n          font-size: 28px !important;\n          font-family: PingFangSC-Regular, PingFang SC;\n          font-weight: 400;\n          color: #ffffff;\n        }\n      }\n    }\n  }\n}\n</style>\n\n<style lang=\"less\">\n.ProposaDetails {\n  .el-dialog {\n    background: #ffffff;\n    border-radius: 24px;\n    padding: 0 40px;\n    .el-dialog__title {\n      padding: 0;\n      margin: 0;\n      font-size: 40px;\n      font-family: PingFangSC-Medium, PingFang SC;\n      font-weight: 500;\n      color: #000000;\n      line-height: 56px;\n    }\n    .el-dialog__header {\n      padding: 0;\n      padding-top: 30px;\n      margin-bottom: 56px;\n    }\n    .el-dialog__body {\n      padding: 0;\n    }\n    .el-input__inner {\n      height: 74px;\n      background: #ffffff;\n      border-radius: 4px;\n      border: 2px solid #999999;\n      font-size: 26px;\n      font-family: PingFangSC-Regular, PingFang SC;\n      font-weight: 400;\n    }\n    .dialog-footer {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 64px;\n      margin-bottom: 60px;\n      .el-button {\n        width: 164px;\n        height: 74px;\n        border-radius: 8px;\n        font-size: 28px;\n        font-family: PingFangSC-Regular, PingFang SC;\n        font-weight: 400;\n        border: none;\n      }\n      .el-button:nth-child(1) {\n        background: #ececec;\n        color: #9f9f9f;\n      }\n      .el-button:nth-child(2) {\n        background: #5432f4;\n        color: #ffffff;\n      }\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/m/Proposal"}]}